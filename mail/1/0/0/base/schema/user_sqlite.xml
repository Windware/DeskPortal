<root>
	<!-- Accounts-->
	<table name="account">
		<column name="id" param="INTEGER PRIMARY KEY NOT NULL" />
		<column name="user" param="INT NOT NULL" />
		<column name="description" param="VARCHAR(255) UNIQUE" />
		<column name="name" param="VARCHAR(255) NOT NULL" />
		<column name="address" param="VARCHAR(255) NOT NULL" />
		<column name="signature" param="TEXT" />

		<column name="receive_type" param="VARCHAR(12) NOT NULL" />
		<column name="receive_host" param="VARCHAR(255) NOT NULL" />
		<column name="receive_port" param="INT NOT NULL" />
		<column name="receive_secure" param="INT NOT NULL" />
		<column name="receive_keep" param="INT" />
		<column name="receive_duration" param="INT" />
		<column name="receive_user" param="VARCHAR(255)" />
		<column name="receive_pass" param="VARCHAR(255)" />

		<column name="send_host" param="VARCHAR(255) NOT NULL" />
		<column name="send_port" param="INT NOT NULL" />
		<column name="send_secure" param="INT NOT NULL" />
		<column name="send_user" param="VARCHAR(255)" />
		<column name="send_pass" param="VARCHAR(255)" />

		<column name="folder_inbox" param="INT" />
		<column name="folder_drafts" param="INT" />
		<column name="folder_sent" param="INT" />
		<column name="folder_trash" param="INT" />

		<column name="UNIQUE" param="(user, description)" />
		<index name="user" />
	</table>

	<!-- Mail lists
		'uid' is a unique identifier for a message provided by the mail server.
		'sequence' is a sequence number of a message provided by the mail server, which may change across sessions.
		'signature' is a md5 sum of the header of a mail to identify the message.

		NOTE : 'sequence' and 'signature' are provided, so that under POP3, since UIDL command is optional,
		a message can be identified in another way to download the attachments separately.
	-->
	<table name="mail">
		<column name="id" param="INTEGER PRIMARY KEY NOT NULL" />
		<column name="user" param="INT NOT NULL" />
		<column name="folder" param="INT NOT NULL" />

		<column name="uid" param="VARCHAR(255)" />
		<column name="sequence" param="INT" />
		<column name="signature" param="CHAR(32)" />

		<column name="subject" param="TEXT NOT NULL" />
		<column name="mail" param="TEXT" /> <!-- Entire mail content -->

		<column name="size" param="INT" />
		<column name="sent" param="DATETIME" />
		<column name="received" param="DATETIME" />

		<column name="preview" param="TEXT" /> <!-- Partial excerpt of the plain text version. Uncompressed to be sent inside XML. -->
		<column name="plain" param="TEXT" /> <!-- Plain text version of the body. Uncompressed for search purpose. -->
		<column name="html" param="BLOB" /> <!-- HTML version of the body compressed -->
		<column name="encode" param="VARCHAR(32)" /> <!-- Character encoding type for HTML version -->

		<column name="marked" param="INT" /> <!-- Corresponds to IMAP flag 'Flagged' -->
		<column name="read" param="INT" /> <!-- Corresponds to IMAP flag 'Seen' -->
		<column name="replied" param="INT" /> <!-- Corresponds to IMAP flag 'Answered' -->
		<column name="draft" param="INT" /> <!-- Corresponds to IMAP flag 'Draft' -->
		<column name="color" param="CHAR(6)" />

		<column name="UNIQUE" param="(user, folder, uid)" />
		<index name="user, folder, uid" />
		<index name="user, folder, sequence" />
		<index name="user, folder, signature" />
	</table>

	<!-- List of folders -->
	<table name="folder">
		<column name="id" param="INTEGER PRIMARY KEY NOT NULL" />
		<column name="user" param="INT NOT NULL" />

		<column name="account" param="INT NOT NULL" />
		<column name="name" param="VARCHAR(255) NOT NULL" />
		<column name="parent" param="INT" /> <!-- Can create child folders or not -->
		<column name="separator" param="VARCHAR(4)" /> <!-- Folder name separater -->
		<column name="updated" param="DATETIME" />

		<column name="UNIQUE" param="(user, account, name)" />
		<index name="user, account, name" />
	</table>

	<!-- From addresses -->
	<table name="from">
		<column name="mail" param="INT NOT NULL" />
		<column name="name" param="VARCHAR(255)" />
		<column name="address" param="VARCHAR(255) NOT NULL" />

		<column name="UNIQUE" param="(mail, address)" />
		<index name="mail" />
	</table>

	<!-- Cc addresses -->
	<table name="cc">
		<column name="mail" param="INT NOT NULL" />
		<column name="name" param="VARCHAR(255)" />
		<column name="address" param="VARCHAR(255) NOT NULL" />

		<column name="UNIQUE" param="(mail, address)" />
		<index name="mail" />
	</table>

	<!-- To addresses -->
	<table name="to">
		<column name="mail" param="INT NOT NULL" />
		<column name="name" param="VARCHAR(255)" />
		<column name="address" param="VARCHAR(255) NOT NULL" />

		<column name="UNIQUE" param="(mail, address)" />
		<index name="mail" />
	</table>

	<!-- Mail attachments -->
	<table name="attachment">
		<column name="id" param="INTEGER PRIMARY KEY NOT NULL" />
		<column name="mail" param="INT NOT NULL" />

		<column name="name" param="TEXT NOT NULL" /> <!-- File name -->
		<column name="type" param="VARCHAR(255)" /> <!-- Mime type -->

		<column name="position" param="VARCHAR(255)" /> <!-- Position of this attachment in the mime structure -->
		<column name="body" param="BLOB" />

		<index name="mail" />
	</table>

	<!-- References to other mails -->
	<table name="reference">
		<column name="id" param="INTEGER PRIMARY KEY NOT NULL" />
		<column name="mail" param="INT NOT NULL" />
		<column name="reference" param="INT NOT NULL" />

		<column name="UNIQUE" param="(mail, reference)" />
		<index name="mail" />
		<index name="reference" />
	</table>
</root>
